<UserControl
    x:Class="Atc.Wpf.Components.UndoRedo.UndoRedoHistoryView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:atc="https://github.com/atc-net/atc-wpf/tree/main/schemas"
    xmlns:atcTranslation="https://github.com/atc-net/atc-wpf/tree/main/schemas/translations"
    xmlns:atcValueConverters="https://github.com/atc-net/atc-wpf/tree/main/schemas/value-converters"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:fontIcons="clr-namespace:Atc.Wpf.FontIcons;assembly=Atc.Wpf.FontIcons"
    xmlns:local="clr-namespace:Atc.Wpf.Components.UndoRedo"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    d:DataContext="{d:DesignInstance Type=local:UndoRedoHistoryViewModel,
                                     IsDesignTimeCreatable=False}"
    d:DesignHeight="400"
    d:DesignWidth="300"
    Focusable="True"
    mc:Ignorable="d">

    <UserControl.InputBindings>
        <KeyBinding
            Key="Z"
            Command="{Binding Path=UndoCommand}"
            Modifiers="Ctrl" />
        <KeyBinding
            Key="Z"
            Command="{Binding Path=UndoAllCommand}"
            Modifiers="Ctrl+Shift" />
        <KeyBinding
            Key="Y"
            Command="{Binding Path=RedoCommand}"
            Modifiers="Ctrl" />
        <KeyBinding
            Key="Y"
            Command="{Binding Path=RedoAllCommand}"
            Modifiers="Ctrl+Shift" />
    </UserControl.InputBindings>

    <UserControl.Resources>
        <Style x:Key="ToolBarIconStyle" TargetType="Image">
            <Style.Triggers>
                <Trigger Property="IsEnabled" Value="False">
                    <Setter Property="Opacity" Value="0.3" />
                </Trigger>
            </Style.Triggers>
        </Style>
    </UserControl.Resources>

    <atc:GridEx Columns="*" Rows="Auto,*">

        <ToolBarTray Grid.Row="0" Visibility="{Binding Path=ShowToolbar, Converter={x:Static atcValueConverters:BoolToVisibilityVisibleValueConverter.Instance}, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:UndoRedoHistoryView}}}">
            <ToolBar ToolBarTray.IsLocked="True">

                <Button Margin="3,0" Command="{Binding Path=UndoAllCommand}">
                    <Button.ToolTip>
                        <ToolTip Content="{atcTranslation:Resx ResxName=Atc.Wpf.Controls.Resources.Miscellaneous, Key=UndoAll}" ContentStringFormat="{}{0} (Ctrl+Shift+Z)" />
                    </Button.ToolTip>
                    <Image
                        Width="16"
                        Height="16"
                        Margin="3"
                        Source="{Binding Source={x:Static fontIcons:FontAwesomeSolidType.FastBackward}, Converter={x:Static atcValueConverters:FontIconImageSourceValueConverter.Instance}, ConverterParameter={StaticResource AtcApps.Brushes.Accent}}"
                        Style="{StaticResource ToolBarIconStyle}" />
                </Button>

                <Button Margin="3,0" Command="{Binding Path=UndoCommand}">
                    <Button.ToolTip>
                        <ToolTip Content="{atcTranslation:Resx ResxName=Atc.Wpf.Controls.Resources.Miscellaneous, Key=Undo}" ContentStringFormat="{}{0} (Ctrl+Z)" />
                    </Button.ToolTip>
                    <Image
                        Width="16"
                        Height="16"
                        Margin="3"
                        Source="{Binding Source={x:Static fontIcons:FontAwesomeSolidType.UndoAlt}, Converter={x:Static atcValueConverters:FontIconImageSourceValueConverter.Instance}, ConverterParameter={StaticResource AtcApps.Brushes.Accent}}"
                        Style="{StaticResource ToolBarIconStyle}" />
                </Button>

                <Button Margin="3,0" Command="{Binding Path=RedoCommand}">
                    <Button.ToolTip>
                        <ToolTip Content="{atcTranslation:Resx ResxName=Atc.Wpf.Controls.Resources.Miscellaneous, Key=Redo}" ContentStringFormat="{}{0} (Ctrl+Y)" />
                    </Button.ToolTip>
                    <Image
                        Width="16"
                        Height="16"
                        Margin="3"
                        Source="{Binding Source={x:Static fontIcons:FontAwesomeSolidType.RedoAlt}, Converter={x:Static atcValueConverters:FontIconImageSourceValueConverter.Instance}, ConverterParameter={StaticResource AtcApps.Brushes.Accent}}"
                        Style="{StaticResource ToolBarIconStyle}" />
                </Button>

                <Button Margin="3,0" Command="{Binding Path=RedoAllCommand}">
                    <Button.ToolTip>
                        <ToolTip Content="{atcTranslation:Resx ResxName=Atc.Wpf.Controls.Resources.Miscellaneous, Key=RedoAll}" ContentStringFormat="{}{0} (Ctrl+Shift+Y)" />
                    </Button.ToolTip>
                    <Image
                        Width="16"
                        Height="16"
                        Margin="3"
                        Source="{Binding Source={x:Static fontIcons:FontAwesomeSolidType.FastForward}, Converter={x:Static atcValueConverters:FontIconImageSourceValueConverter.Instance}, ConverterParameter={StaticResource AtcApps.Brushes.Accent}}"
                        Style="{StaticResource ToolBarIconStyle}" />
                </Button>

                <Separator Margin="5,0" Visibility="{Binding Path=ShowMarkSaved, Converter={x:Static atcValueConverters:BoolToVisibilityVisibleValueConverter.Instance}, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:UndoRedoHistoryView}}}" />

                <Button
                    Margin="3,0"
                    Command="{Binding Path=MarkSavedCommand}"
                    ToolTip="Mark Saved"
                    Visibility="{Binding Path=ShowMarkSaved, Converter={x:Static atcValueConverters:BoolToVisibilityVisibleValueConverter.Instance}, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:UndoRedoHistoryView}}}">
                    <Image
                        Width="16"
                        Height="16"
                        Margin="3"
                        Source="{Binding Source={x:Static fontIcons:FontAwesomeSolidType.Save}, Converter={x:Static atcValueConverters:FontIconImageSourceValueConverter.Instance}, ConverterParameter={StaticResource AtcApps.Brushes.Accent}}"
                        Style="{StaticResource ToolBarIconStyle}" />
                </Button>

                <Separator Margin="5,0" Visibility="{Binding Path=ShowClear, Converter={x:Static atcValueConverters:BoolToVisibilityVisibleValueConverter.Instance}, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:UndoRedoHistoryView}}}" />

                <Button
                    Margin="3,0"
                    Command="{Binding Path=ClearCommand}"
                    ToolTip="{atcTranslation:Resx ResxName=Atc.Wpf.Controls.Resources.Miscellaneous,
                                                  Key=ClearHistory}"
                    Visibility="{Binding Path=ShowClear, Converter={x:Static atcValueConverters:BoolToVisibilityVisibleValueConverter.Instance}, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:UndoRedoHistoryView}}}">
                    <Image
                        Width="16"
                        Height="16"
                        Source="{Binding Source={x:Static fontIcons:FontAwesomeSolidType.Trash}, Converter={x:Static atcValueConverters:FontIconImageSourceValueConverter.Instance}, ConverterParameter={StaticResource AtcApps.Brushes.Accent}}"
                        Style="{StaticResource ToolBarIconStyle}" />
                </Button>

            </ToolBar>
        </ToolBarTray>

        <ListView
            x:Name="LvHistory"
            Grid.Row="1"
            ItemsSource="{Binding Path=HistoryItems}"
            SelectedItem="{Binding Path=SelectedItem, Mode=TwoWay}"
            SelectionChanged="OnSelectionChanged"
            SelectionMode="Single">
            <ListView.ItemTemplate>
                <DataTemplate DataType="local:UndoRedoHistoryItem">
                    <TextBlock Text="{Binding Path=Description}">
                        <TextBlock.Style>
                            <Style TargetType="TextBlock">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding Path=IsRedo}" Value="True">
                                        <Setter Property="FontStyle" Value="Italic" />
                                        <Setter Property="Opacity" Value="0.6" />
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding Path=IsHighlighted}" Value="True">
                                        <Setter Property="FontWeight" Value="Bold" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TextBlock.Style>
                    </TextBlock>
                </DataTemplate>
            </ListView.ItemTemplate>
            <ListView.ItemContainerStyle>
                <Style BasedOn="{StaticResource {x:Type ListViewItem}}" TargetType="ListViewItem">
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding Path=IsHighlighted}" Value="True">
                            <Setter Property="Background" Value="{DynamicResource AtcApps.Brushes.Accent}" />
                            <Setter Property="Foreground" Value="{DynamicResource AtcApps.Brushes.IdealForeground}" />
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </ListView.ItemContainerStyle>
        </ListView>

    </atc:GridEx>

</UserControl>
